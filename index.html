<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Battlezone Acquisition 2025</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <div class="background"></div>
  <header class="header">
    <h1>ğŸ† Battlezone Acquisition 2025</h1>
    <div id="countdown" class="countdown">Loading countdown...</div>
  </header>

  <section class="leaderboard-section">
    <h2>ğŸ¥‡ Leaderboard Tim</h2>
    <div class="leaderboard">
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Tim</th>
            <th>Total Poin</th>
          </tr>
        </thead>
        <tbody id="leaderboard-body"></tbody>
      </table>
    </div>

    <section id="last-merchant">
      <h3>ğŸ“Œ Merchant Terakhir Diakuisisi</h3>
      <div id="merchant-info">
        <p>Loading...</p>
      </div>
    </section>

    <div class="menu-buttons">
      <button onclick="document.getElementById('reward-section').scrollIntoView({ behavior: 'smooth' })">
        ğŸ Daftar Hadiah
      </button>
      <button class="wide-button" onclick="document.getElementById('detail-individu').scrollIntoView({ behavior: 'smooth' })">
        ğŸ§¾ Detail Pencapaian Individu
      </button>
    </div>
  </section>

  <section class="reward-section" id="reward-section">
    <h2>ğŸ Daftar Hadiah</h2>
    <div class="reward-grid reward-centered">
      <div class="reward-item">
        <img src="assets/silver-medal.png" class="reward-img" alt="Silver Medal" />
        <p>ğŸ¥ˆ Juara 2<br>Silver Medal</p>
      </div>
      <div class="reward-item reward-winner">
        <div class="reward-combo">
          <img src="assets/gold-medal.png" class="reward-img-combo" alt="Gold Medal" />
          <span class="plus-sign">+</span>
          <img src="assets/gift.png" class="reward-img-combo" alt="Gift" />
        </div>
        <p>ğŸ¥‡ Juara 1<br>Gold Medal + Cash<br>Rp300.000</p>
      </div>
      <div class="reward-item">
        <img src="assets/bronze-medal.png" class="reward-img" alt="Bronze Medal" />
        <p>ğŸ¥‰ Juara 3<br>Bronze Medal</p>
      </div>
    </div>
  </section>

  <section class="detail-section" id="detail-individu">
    <h2>ğŸ§¾ Detail Pencapaian Individu</h2>
    <div id="individual-cards"></div>
  </section>

  <section class="detail-section">
    <h2>ğŸ“‹ Detail Akuisisi Anggota</h2>
    <div class="accordion">
      <div class="accordion-item">
        <button class="accordion-button">ğŸ¯ Tim Alpha</button>
        <div class="accordion-content"><ul></ul></div>
      </div>
      <div class="accordion-item">
        <button class="accordion-button">ğŸ¯ Tim Bravo</button>
        <div class="accordion-content"><ul></ul></div>
      </div>
      <div class="accordion-item">
        <button class="accordion-button">ğŸ¯ Tim Charlie</button>
        <div class="accordion-content"><ul></ul></div>
      </div>
    </div>
  </section>

  <script>
    function countdownTimer() {
      const el = document.getElementById('countdown');
      const now = new Date();
      const target = new Date(now.getFullYear(), now.getMonth() + 1, 1, 8, 0, 0);
      const dist = target - now;
      if (dist <= 0) return el.innerHTML = "Leaderboard disembunyikan. Hasil diumumkan hari Senin!";
      const d = Math.floor(dist / (1000 * 60 * 60 * 24));
      const h = Math.floor((dist % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const m = Math.floor((dist % (1000 * 60 * 60)) / (1000 * 60));
      const s = Math.floor((dist % (1000 * 60)) / 1000);
      el.innerHTML = `Reset dalam: ${d}h ${h}j ${m}m ${s}s`;
    }
    setInterval(countdownTimer, 1000);

    document.querySelectorAll('.accordion-button').forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('active');
        const content = btn.nextElementSibling;
        content.style.maxHeight = content.style.maxHeight ? null : content.scrollHeight + 'px';
      });
    });

    async function fetchLeaderboard() {
      const res = await fetch('https://opensheet.elk.sh/1Cxpf0WMF0IPlNbhaQHjh6cetou73JnJWxN1etdNkIII/LeaderboardTim');
      const data = await res.json();
      const tbody = document.getElementById('leaderboard-body');
      tbody.innerHTML = '';
      data.forEach(row => {
        tbody.innerHTML += `<tr><td>${row.Rank}</td><td>${row['Nama Tim']}</td><td>${row['Total Poin']}</td></tr>`;
      });
    }
    fetchLeaderboard();

    async function fetchDetailAnggota() {
      const res = await fetch('https://opensheet.elk.sh/1Cxpf0WMF0IPlNbhaQHjh6cetou73JnJWxN1etdNkIII/DetailAnggota');
      const data = await res.json();
      document.querySelectorAll('.accordion-item').forEach(item => {
        const tim = item.querySelector('.accordion-button').textContent.replace('ğŸ¯ ', '').trim();
        const ul = item.querySelector('ul');
        ul.innerHTML = '';
        data.filter(a => a['Nama Tim'] === tim).forEach(a => {
          let isi = '';
          ['Livin','Giro','EDC','Tabungan Now','Kopra','Visit Point','Tabungan Bisnis'].forEach(p => {
            if (a[p] && parseInt(a[p]) > 0) isi += `- ${p}: ${a[p]}<br>`;
          });
          const update = a['Last Update'] || 'Belum update';
          const total = a['Total Poin Anggota'] || '0';
          ul.innerHTML += `<li><strong>${a['Nama Anggota']}</strong><br>${isi}<em>Update: ${update}</em><br><em>Total Poin: ${total}</em></li>`;
        });
      });

      const cardWrapper = document.getElementById('individual-cards');
      const grouped = { 'Tim Alpha': [], 'Tim Bravo': [], 'Tim Charlie': [] };
      data.forEach(a => grouped[a['Nama Tim']].push(a));
      for (const [team, members] of Object.entries(grouped)) {
        const section = document.createElement('div');
        section.innerHTML = `<h3 class=\"team-header\">${team}</h3>`;
        const grid = document.createElement('div');
        grid.className = 'card-grid';
        members.forEach(a => {
          let isi = '';
          ['Livin','Giro','EDC','Tabungan Now','Kopra','Visit Point','Tabungan Bisnis'].forEach(p => {
            if (a[p] && parseInt(a[p]) > 0) isi += `<span>${p}: ${a[p]}</span>`;
          });
          const update = a['Last Update'] || 'Belum update';
          const total = a['Total Poin Anggota'] || '0';
          const card = document.createElement('div');
          card.className = 'anggota-card';
          card.innerHTML = `
            <h4>ğŸ‘¤ ${a['Nama Anggota']}</h4>
            <div class=\"card-body\">${isi}</div>
            <p class=\"card-foot\">ğŸ—“ ${update} &nbsp; â­ ${total} Poin</p>
          `;
          grid.appendChild(card);
        });
        section.appendChild(grid);
        cardWrapper.appendChild(section);
      }
    }
    fetchDetailAnggota();

    async function fetchLastMerchant() {
      const res = await fetch(\"https://opensheet.elk.sh/1Cxpf0WMF0IPlNbhaQHjh6cetou73JnJWxN1etdNkIII/MerchantTerakhir\");
      const data = await res.json();
      const m = data[0];
      document.getElementById(\"merchant-info\").innerHTML = `
        <p>ğŸª <strong>${m.Merchant}</strong></p>
        <p>ğŸ‘¤ Oleh: ${m.Oleh}</p>
        <p>ğŸ“ Produk: ${m.Produk}</p>
        <p>ğŸ—“ï¸ Tanggal: ${m.Tanggal}</p>
      `;
    }
    fetchLastMerchant();
  </script>
</body>
</html>
