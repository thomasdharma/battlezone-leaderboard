<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Mapping Zone Kawasan</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* safe-area support */
    :root { --safe-top: env(safe-area-inset-top); }

    html, body {
      height:100%; margin:0; padding:0;
      font-family:'Orbitron',sans-serif;
      background:#0d0d0d url('assets/neon-bg.png') center/cover no-repeat fixed;
    }
    body { padding-top: calc(var(--safe-top) + 10px); }

    .background {
      position:fixed; top:0; left:0; width:100%; height:100%;
      z-index:-1;
    }

    /* Enhanced Info & Control Panel */
    .info-panel {
      position:absolute;
      top: calc(var(--safe-top) + 10px);
      left:50%; transform:translateX(-50%);
      width:90%; max-width:360px;
      background: rgba(0,0,0,0.5);
      border: 2px solid #0ff;
      border-radius: 12px;
      backdrop-filter: blur(6px);
      box-shadow: 0 0 20px rgba(0,255,255,0.4);
      color:#0ff;
      overflow:hidden;
      transition: max-height 0.4s ease;
      max-height: 300px;
      z-index:2;
    }
    .info-panel:not([open]) { max-height: 48px; }
    .info-panel summary {
      list-style:none;
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 16px;
      font-size:1.1em; font-weight:bold;
      cursor:pointer;
    }
    .info-panel summary::marker { content:none; }
    .info-panel summary:hover { background: rgba(0,255,255,0.2); }
    .info-content {
      padding:0 16px 16px;
      text-align:center;
    }
    .info-content h1 { margin:8px 0 4px; font-size:1.5em; text-shadow:0 0 8px #0ff; }
    .info-content p.subtitle { margin:0 0 8px; font-size:0.9em; color:#8ff; }
    .info-content .summary { margin-bottom:12px; font-size:0.9em; }
    .controls { display:flex; justify-content:center; gap:8px; }
    .controls button {
      flex:1;
      background: linear-gradient(90deg,#0ff,#00cfcf);
      color:#000; font-weight:bold;
      border:none; padding:8px; border-radius:8px;
      box-shadow:0 2px 8px rgba(0,255,255,0.4);
      cursor:pointer; transition:transform 0.2s;
      font-size:0.9em;
    }
    .controls button:hover { transform:scale(1.05); }

    /* Map container (unchanged) */
    #map {
      position:relative;
      width:90%; max-width:1200px;
      height:calc(100vh - (var(--safe-top) + 90px));
      margin:0 auto;
      border-radius:12px;
      box-shadow:0 0 20px rgba(0,0,0,0.6);
      touch-action:pan-x pan-y;
      z-index:1;
    }
    #map.animate { transform:scale(1.02); }

    /* Floating legend inside map */
    .map-legend {
      position:absolute; bottom:12px; right:12px;
      background:rgba(0,0,0,0.5);
      padding:6px 10px; border-radius:8px;
      color:#fff; font-size:12px;
      box-shadow:0 0 10px rgba(0,0,0,0.7);
      z-index:2;
    }
    .map-legend div { display:flex; align-items:center; margin-bottom:4px; }
    .map-legend .legend-color { width:10px; height:10px; border-radius:50%; margin-right:6px; }

    @media(max-width:600px) {
      #map { width:95%; }
    }
  </style>
</head>
<body>
  <div class="background"></div>

  <details open class="info-panel">
    <summary>‚ÑπÔ∏è Info & Kontrol <span>&#x25BC;</span></summary>
    <div class="info-content">
      <h1>üåê Mapping Zone Kawasan</h1>
      <p class="subtitle">Bank Mandiri Lapangan Merdeka</p>
      <p class="summary" id="summary-text">Loading data akuisisi...</p>
      <div class="controls">
        <button id="toggle-style">üåì Ganti Tampilan Map</button>
      </div>
    </div>
  </details>

  <div id="map">
    <div class="map-legend">
      <div><span class="legend-color" style="background:#0066cc"></span>Tim Alpha</div>
      <div><span class="legend-color" style="background:#cc0000"></span>Tim Bravo</div>
      <div><span class="legend-color" style="background:#00cc44"></span>Tim Charlie</div>
    </div>
  </div>

  <!-- existing scripts unchanged -->
  <script>
    const teamColors = { 'Tim Alpha': '#0066cc', 'Tim Bravo': '#cc0000', 'Tim Charlie': '#00cc44' };
    const teamGradients = { 'Tim Alpha': ['rgba(0,0,0,0)','rgba(0,102,204,0.4)','rgba(0,102,204,1)'], 'Tim Bravo': ['rgba(0,0,0,0)','rgba(204,0,0,0.4)','rgba(204,0,0,1)'], 'Tim Charlie':['rgba(0,0,0,0)','rgba(0,204,68,0.4)','rgba(0,204,68,1)'] };
    const darkMapStyle = [ /* ...same style array... */ ];
    let map;
    function initMap() {
      const center = { lat:3.566559, lng:98.694630 };
      map = new google.maps.Map(document.getElementById('map'), { center, zoom:13, gestureHandling:'greedy', disableDoubleClickZoom:true, zoomControl:true, streetViewControl:false });
      // My Location control omitted here for brevity
      new google.maps.KmlLayer({ url:'https://www.google.com/maps/d/kml?forcekml=1&mid=11uDxJ_HJDwN9UbU9ihAhrloBmR--18o', preserveViewport:true, clickable:false, map });
      loadMerchantData(); setInterval(loadMerchantData,180000);
    }
    function loadMerchantData() { /* unchanged */ }
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('toggle-style').addEventListener('click',()=>{
        const styles=map.get('styles'); map.setOptions({ styles:styles?null:darkMapStyle });
        document.getElementById('map').classList.add('animate'); setTimeout(()=>document.getElementById('map').classList.remove('animate'),500);
      });
    });
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwuSerwi_mY5J89CihWaUZ6Itl_0ywIto&libraries=visualization&callback=initMap" async defer></script>
</body>
</html>
