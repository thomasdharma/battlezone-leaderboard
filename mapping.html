<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mapping Zone Kawasan</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <div class="background"></div>
  <header class="header">
    <h1>üåê Mapping Zone Kawasan</h1>
    <p>Bank Mandiri Lapangan Merdeka</p>
  </header>

  <section class="leaderboard-section">
    <div id="map"></div>
  </section>

  <!-- Google Maps JS dengan Heatmap library -->
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwuSerwi_mY5J89CihWaUZ6Itl_0ywIto&libraries=visualization&callback=initMap"
    async
  ></script>
  <script>
    function initMap() {
      const center = { lat: 3.566559, lng: 98.694630 };
      const map = new google.maps.Map(document.getElementById("map"), {
        center,
        zoom: 13,
      });

      fetch("https://opensheet.elk.sh/1Cxpf0WMF0IPlNbhaQHjh6cetou73JnJWxN1etdNkIII/Akuisisi%20Merchant")
        .then(res => res.json())
        .then(data => {
          const heatData = [];
          data.forEach(item => {
            const lat = parseFloat(item.Lat), lng = parseFloat(item.Lng);
            if (isNaN(lat) || isNaN(lng)) return;

            heatData.push(new google.maps.LatLng(lat, lng));

            const marker = new google.maps.Marker({
              position: { lat, lng },
              map,
            });
            const info = new google.maps.InfoWindow({
              content: `
                <strong>${item['Nama Toko']}</strong><br>
                Produk: ${item.Produk}<br>
                Tanggal: ${item.Tanggal}<br>
                PIC: ${item.PIC}
              `,
            });
            marker.addListener("click", () => info.open(map, marker));
          });

          new google.maps.visualization.HeatmapLayer({
            data: heatData,
            radius: 40,
          }).setMap(map);
        })
        .catch(err => console.error("Gagal load data akuisisi:", err));
    }
  </script>
</body>
</html>
